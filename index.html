<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Hill Climb Racing - Full Clone</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'Arial Black', sans-serif;
            overflow: hidden;
        }
        
        .game-wrapper {
            position: relative;
            width: 100vw;
            height: 100vh;
            max-width: 1400px;
            max-height: 700px;
        }
        
        canvas {
            display: block;
            width: 100%;
            height: 100%;
        }
        
        .hud {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            pointer-events: none;
        }
        
        .hud-left, .hud-right {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .hud-center {
            text-align: center;
        }
        
        .stat-panel {
            background: linear-gradient(180deg, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.6) 100%);
            border: 3px solid #ffd700;
            border-radius: 15px;
            padding: 10px 20px;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            min-width: 150px;
        }
        
        .stat-label {
            font-size: 12px;
            color: #aaa;
            text-transform: uppercase;
        }
        
        .stat-value {
            font-size: 28px;
            color: #fff;
            font-weight: bold;
        }
        
        .stat-value.coins {
            color: #ffd700;
        }
        
        .stat-value.fuel {
            color: #ff6b6b;
        }
        
        .fuel-bar-container {
            width: 100%;
            height: 20px;
            background: #333;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 5px;
            border: 2px solid #555;
        }
        
        .fuel-bar {
            height: 100%;
            background: linear-gradient(90deg, #ff4444, #ff8800, #44ff44);
            transition: width 0.3s;
            border-radius: 8px;
        }
        
        .speed-display {
            background: linear-gradient(180deg, #1a1a2e 0%, #0a0a15 100%);
            border: 3px solid #4ecdc4;
            border-radius: 50%;
            width: 100px;
            height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        .speed-value {
            font-size: 32px;
            color: #4ecdc4;
            font-weight: bold;
        }
        
        .speed-unit {
            font-size: 12px;
            color: #888;
        }
        
        .mobile-controls {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            pointer-events: none;
        }
        
        .control-group {
            display: flex;
            gap: 15px;
            pointer-events: auto;
        }
        
        .ctrl-btn {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            border: 4px solid rgba(255,255,255,0.8);
            background: rgba(255,255,255,0.15);
            color: white;
            font-size: 36px;
            cursor: pointer;
            user-select: none;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.1s;
            backdrop-filter: blur(5px);
        }
        
        .ctrl-btn:active, .ctrl-btn.active {
            background: rgba(255,255,255,0.4);
            transform: scale(0.95);
        }
        
        .ctrl-btn.gas {
            border-color: #44ff44;
            box-shadow: 0 0 20px rgba(68, 255, 68, 0.5);
        }
        
        .ctrl-btn.brake {
            border-color: #ff4444;
            box-shadow: 0 0 20px rgba(255, 68, 68, 0.5);
        }
        
        #gameOverScreen, #startScreen, #pauseScreen {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            z-index: 100;
        }
        
        #startScreen {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        }
        
        .game-title {
            font-size: 64px;
            color: #ffd700;
            text-shadow: 4px 4px 8px rgba(0,0,0,0.8), 0 0 40px rgba(255, 215, 0, 0.5);
            margin-bottom: 10px;
            text-align: center;
        }
        
        .game-subtitle {
            font-size: 24px;
            color: #4ecdc4;
            margin-bottom: 40px;
        }
        
        .menu-btn {
            padding: 20px 60px;
            font-size: 24px;
            font-weight: bold;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s;
            text-transform: uppercase;
        }
        
        .menu-btn.primary {
            background: linear-gradient(180deg, #4CAF50 0%, #2d7d32 100%);
            color: white;
            box-shadow: 0 6px 0 #1b5e20, 0 10px 20px rgba(0,0,0,0.4);
        }
        
        .menu-btn.primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 9px 0 #1b5e20, 0 15px 30px rgba(0,0,0,0.4);
        }
        
        .menu-btn.primary:active {
            transform: translateY(3px);
            box-shadow: 0 3px 0 #1b5e20, 0 5px 10px rgba(0,0,0,0.4);
        }
        
        .menu-btn.secondary {
            background: linear-gradient(180deg, #ff9800 0%, #e65100 100%);
            color: white;
            box-shadow: 0 6px 0 #bf360c, 0 10px 20px rgba(0,0,0,0.4);
        }
        
        .stats-summary {
            background: rgba(0,0,0,0.5);
            border: 3px solid #ffd700;
            border-radius: 20px;
            padding: 30px 50px;
            margin: 20px;
            text-align: center;
        }
        
        .stats-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            min-width: 300px;
        }
        
        .stats-row:last-child {
            border-bottom: none;
        }
        
        .stats-row .label {
            color: #aaa;
            font-size: 18px;
        }
        
        .stats-row .value {
            color: #ffd700;
            font-size: 24px;
            font-weight: bold;
        }
        
        .vehicle-select {
            display: flex;
            gap: 20px;
            margin: 30px 0;
        }
        
        .vehicle-option {
            background: rgba(255,255,255,0.1);
            border: 3px solid #444;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .vehicle-option:hover {
            border-color: #ffd700;
            background: rgba(255,215,0,0.1);
        }
        
        .vehicle-option.selected {
            border-color: #4ecdc4;
            background: rgba(78,205,196,0.2);
            box-shadow: 0 0 20px rgba(78,205,196,0.5);
        }
        
        .vehicle-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }
        
        .vehicle-name {
            color: white;
            font-size: 16px;
        }
        
        .hidden {
            display: none !important;
        }
        
        .achievement {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(180deg, rgba(255,215,0,0.9) 0%, rgba(255,165,0,0.9) 100%);
            padding: 20px 40px;
            border-radius: 15px;
            color: #000;
            font-size: 24px;
            font-weight: bold;
            animation: achievementPop 2s ease-out forwards;
            z-index: 50;
        }
        
        @keyframes achievementPop {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
            20% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
            30% { transform: translate(-50%, -50%) scale(1); }
            80% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
            100% { transform: translate(-50%, -100%) scale(0.8); opacity: 0; }
        }
        
        .air-time {
            position: absolute;
            top: 40%;
            left: 50%;
            transform: translateX(-50%);
            color: #ffd700;
            font-size: 48px;
            font-weight: bold;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.8);
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .air-time.visible {
            opacity: 1;
        }
        
        @media (max-width: 768px) {
            .game-title { font-size: 36px; }
            .stat-panel { padding: 8px 12px; min-width: 100px; }
            .stat-value { font-size: 20px; }
            .speed-display { width: 70px; height: 70px; }
            .speed-value { font-size: 22px; }
            .ctrl-btn { width: 70px; height: 70px; font-size: 28px; }
        }
    </style>
</head>
<body>
    <div class="game-wrapper">
        <canvas id="gameCanvas"></canvas>
        
        <!-- HUD -->
        <div class="hud">
            <div class="hud-left">
                <div class="stat-panel">
                    <div class="stat-label">Distance</div>
                    <div class="stat-value" id="distanceDisplay">0 m</div>
                </div>
                <div class="stat-panel">
                    <div class="stat-label">Best</div>
                    <div class="stat-value" id="bestDisplay">0 m</div>
                </div>
            </div>
            
            <div class="hud-center">
                <div class="speed-display">
                    <div class="speed-value" id="speedDisplay">0</div>
                    <div class="speed-unit">km/h</div>
                </div>
            </div>
            
            <div class="hud-right">
                <div class="stat-panel">
                    <div class="stat-label">üí∞ Coins</div>
                    <div class="stat-value coins" id="coinsDisplay">0</div>
                </div>
                <div class="stat-panel">
                    <div class="stat-label">‚õΩ Fuel</div>
                    <div class="fuel-bar-container">
                        <div class="fuel-bar" id="fuelBar"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Air Time Display -->
        <div class="air-time" id="airTime">üöÄ AIR TIME!</div>
        
        <!-- Mobile Controls -->
        <div class="mobile-controls" id="mobileControls">
            <div class="control-group">
                <button class="ctrl-btn brake" id="brakeBtn">‚óÄ</button>
                <button class="ctrl-btn" id="leanBackBtn">‚Ü∂</button>
            </div>
            <div class="control-group">
                <button class="ctrl-btn" id="leanFwdBtn">‚Ü∑</button>
                <button class="ctrl-btn gas" id="gasBtn">‚ñ∂</button>
            </div>
        </div>
        
        <!-- Start Screen -->
        <div id="startScreen">
            <div class="game-title">üèîÔ∏è HILL CLIMB</div>
            <div class="game-subtitle">RACING</div>
            
            <div class="vehicle-select">
                <div class="vehicle-option selected" data-vehicle="jeep">
                    <div class="vehicle-icon">üöô</div>
                    <div class="vehicle-name">JEEP</div>
                </div>
                <div class="vehicle-option" data-vehicle="motorcycle">
                    <div class="vehicle-icon">üèçÔ∏è</div>
                    <div class="vehicle-name">MOTOCROSS</div>
                </div>
                <div class="vehicle-option" data-vehicle="monster">
                    <div class="vehicle-icon">üöó</div>
                    <div class="vehicle-name">MONSTER TRUCK</div>
                </div>
                <div class="vehicle-option" data-vehicle="tank">
                    <div class="vehicle-icon">üõ°Ô∏è</div>
                    <div class="vehicle-name">TANK</div>
                </div>
            </div>
            
            <button class="menu-btn primary" id="startBtn">‚ñ∂ START GAME</button>
        </div>
        
        <!-- Game Over Screen -->
        <div id="gameOverScreen" class="hidden">
            <div class="game-title" style="color: #ff4444;">GAME OVER</div>
            
            <div class="stats-summary">
                <div class="stats-row">
                    <span class="label">Distance</span>
                    <span class="value" id="finalDistance">0 m</span>
                </div>
                <div class="stats-row">
                    <span class="label">Coins Collected</span>
                    <span class="value" id="finalCoins">0</span>
                </div>
                <div class="stats-row">
                    <span class="label">Best Flip</span>
                    <span class="value" id="finalFlips">0</span>
                </div>
                <div class="stats-row">
                    <span class="label">Max Air Time</span>
                    <span class="value" id="finalAirTime">0.0s</span>
                </div>
            </div>
            
            <button class="menu-btn primary" id="restartBtn">üîÑ TRY AGAIN</button>
            <button class="menu-btn secondary" id="menuBtn">üè† MAIN MENU</button>
        </div>
    </div>

    <script>
        // Canvas setup
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        function resizeCanvas() {
            const wrapper = document.querySelector('.game-wrapper');
            canvas.width = wrapper.clientWidth;
            canvas.height = wrapper.clientHeight;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        
        // Game configuration
        const CONFIG = {
            gravity: 0.4,
            friction: 0.98,
            airResistance: 0.997,
            groundFriction: 0.94,
            maxSpeed: 25,
            fuelConsumption: 0.03,
            coinFuelBonus: 15
        };
        
        // Vehicle configurations
        const VEHICLES = {
            jeep: {
                name: 'Jeep',
                wheelBase: 85,
                wheelRadius: 22,
                bodyWidth: 110,
                bodyHeight: 45,
                power: 0.45,
                weight: 1,
                suspension: 30,
                maxSuspension: 40,
                color1: '#2d5a27',
                color2: '#1e3d1a',
                drawBody: drawJeepBody
            },
            motorcycle: {
                name: 'Motocross',
                wheelBase: 70,
                wheelRadius: 20,
                bodyWidth: 80,
                bodyHeight: 30,
                power: 0.55,
                weight: 0.7,
                suspension: 25,
                maxSuspension: 35,
                color1: '#e74c3c',
                color2: '#c0392b',
                drawBody: drawMotorcycleBody
            },
            monster: {
                name: 'Monster Truck',
                wheelBase: 100,
                wheelRadius: 35,
                bodyWidth: 120,
                bodyHeight: 50,
                power: 0.5,
                weight: 1.3,
                suspension: 40,
                maxSuspension: 55,
                color1: '#9b59b6',
                color2: '#8e44ad',
                drawBody: drawMonsterBody
            },
            tank: {
                name: 'Tank',
                wheelBase: 110,
                wheelRadius: 25,
                bodyWidth: 140,
                bodyHeight: 55,
                power: 0.35,
                weight: 1.8,
                suspension: 20,
                maxSuspension: 30,
                color1: '#34495e',
                color2: '#2c3e50',
                drawBody: drawTankBody
            }
        };
        
        // Game state
        let gameState = 'menu'; // menu, playing, paused, gameover
        let selectedVehicle = 'jeep';
        let distance = 0;
        let bestDistance = parseInt(localStorage.getItem('hillClimbBest')) || 0;
        let coins = 0;
        let totalCoins = parseInt(localStorage.getItem('hillClimbCoins')) || 0;
        let fuel = 100;
        let cameraX = 0;
        let cameraY = 0;
        let time = 0;
        let airTime = 0;
        let maxAirTime = 0;
        let flipCount = 0;
        let bestFlip = 0;
        let lastAngle = 0;
        let totalRotation = 0;
        
        // Terrain
        const terrainPoints = [];
        const terrainSegmentWidth = 40;
        let terrainGenerated = 0;
        
        // Game objects
        const coinObjects = [];
        const fuelCans = [];
        const particles = [];
        const dustParticles = [];
        
        // Vehicle
        let vehicle = null;
        
        function createVehicle(type) {
            const config = VEHICLES[type];
            return {
                x: 300,
                y: 200,
                vx: 0,
                vy: 0,
                angle: 0,
                angularVelocity: 0,
                ...config,
                wheels: {
                    front: { x: 0, y: 0, grounded: false, compression: 0, rotation: 0 },
                    rear: { x: 0, y: 0, grounded: false, compression: 0, rotation: 0 }
                },
                engineRunning: false
            };
        }
        
        // Controls
        const keys = {
            gas: false,
            brake: false,
            leanForward: false,
            leanBack: false
        };
        
        // Generate terrain
        function generateTerrain() {
            if (terrainPoints.length === 0) {
                // Starting flat area
                for (let i = 0; i < 15; i++) {
                    terrainPoints.push({
                        x: i * terrainSegmentWidth,
                        y: canvas.height * 0.65
                    });
                }
                terrainGenerated = 15 * terrainSegmentWidth;
            }
            
            while (terrainGenerated < cameraX + canvas.width + 1000) {
                const lastPoint = terrainPoints[terrainPoints.length - 1];
                const difficulty = Math.min(distance / 2000, 1);
                
                // Various terrain patterns
                const pattern = Math.random();
                let newY;
                
                if (pattern < 0.25) {
                    // Steep uphill
                    newY = lastPoint.y - (30 + Math.random() * 50 * difficulty);
                } else if (pattern < 0.45) {
                    // Steep downhill
                    newY = lastPoint.y + (30 + Math.random() * 50 * difficulty);
                } else if (pattern < 0.6) {
                    // Bumpy
                    newY = lastPoint.y + Math.sin(terrainGenerated * 0.05) * 40 * difficulty;
                } else if (pattern < 0.75) {
                    // Jump ramp
                    const rampProgress = (terrainGenerated % 200) / 200;
                    if (rampProgress < 0.5) {
                        newY = lastPoint.y - 40 * difficulty;
                    } else {
                        newY = lastPoint.y + 30 * difficulty;
                    }
                } else {
                    // Gentle rolling
                    newY = lastPoint.y + (Math.random() - 0.5) * 30;
                }
                
                // Clamp terrain
                newY = Math.max(canvas.height * 0.25, Math.min(canvas.height * 0.8, newY));
                
                terrainPoints.push({
                    x: terrainGenerated,
                    y: newY
                });
                
                // Add coins
                if (Math.random() < 0.12) {
                    coinObjects.push({
                        x: terrainGenerated,
                        y: newY - 60 - Math.random() * 80,
                        collected: false,
                        value: Math.random() < 0.1 ? 5 : 1,
                        bobOffset: Math.random() * Math.PI * 2
                    });
                }
                
                // Add fuel cans
                if (Math.random() < 0.04) {
                    fuelCans.push({
                        x: terrainGenerated,
                        y: newY - 50,
                        collected: false
                    });
                }
                
                terrainGenerated += terrainSegmentWidth;
            }
            
            // Cleanup old points
            while (terrainPoints.length > 0 && terrainPoints[0].x < cameraX - 500) {
                terrainPoints.shift();
            }
        }
        
        function getTerrainHeight(x) {
            for (let i = 0; i < terrainPoints.length - 1; i++) {
                if (x >= terrainPoints[i].x && x < terrainPoints[i + 1].x) {
                    const t = (x - terrainPoints[i].x) / terrainSegmentWidth;
                    // Smooth interpolation
                    const smoothT = t * t * (3 - 2 * t);
                    return terrainPoints[i].y + smoothT * (terrainPoints[i + 1].y - terrainPoints[i].y);
                }
            }
            return canvas.height * 0.65;
        }
        
        function getTerrainAngle(x) {
            for (let i = 0; i < terrainPoints.length - 1; i++) {
                if (x >= terrainPoints[i].x && x < terrainPoints[i + 1].x) {
                    const dx = terrainPoints[i + 1].x - terrainPoints[i].x;
                    const dy = terrainPoints[i + 1].y - terrainPoints[i].y;
                    return Math.atan2(dy, dx);
                }
            }
            return 0;
        }
        
        function getTerrainNormal(x) {
            const angle = getTerrainAngle(x);
            return { x: -Math.sin(angle), y: -Math.cos(angle) };
        }
        
        // Physics update
        function updatePhysics() {
            if (!vehicle || gameState !== 'playing') return;
            
            const v = vehicle;
            const config = VEHICLES[selectedVehicle];
            
            // Update wheel positions
            const cosA = Math.cos(v.angle);
            const sinA = Math.sin(v.angle);
            
            v.wheels.front.x = v.x + cosA * (v.wheelBase / 2);
            v.wheels.front.y = v.y + sinA * (v.wheelBase / 2);
            v.wheels.rear.x = v.x - cosA * (v.wheelBase / 2);
            v.wheels.rear.y = v.y - sinA * (v.wheelBase / 2);
            
            // Ground detection
            const frontTerrainY = getTerrainHeight(v.wheels.front.x);
            const rearTerrainY = getTerrainHeight(v.wheels.rear.x);
            
            const frontBottom = v.wheels.front.y + v.suspension;
            const rearBottom = v.wheels.rear.y + v.suspension;
            
            v.wheels.front.grounded = frontBottom >= frontTerrainY - v.wheelRadius;
            v.wheels.rear.grounded = rearBottom >= rearTerrainY - v.wheelRadius;
            
            const grounded = v.wheels.front.grounded || v.wheels.rear.grounded;
            
            // Air time tracking
            if (!grounded) {
                airTime += 1/60;
                maxAirTime = Math.max(maxAirTime, airTime);
                
                // Track flips
                const angleDiff = v.angle - lastAngle;
                totalRotation += angleDiff;
                
                if (Math.abs(totalRotation) >= Math.PI * 2) {
                    flipCount++;
                    bestFlip = Math.max(bestFlip, flipCount);
                    totalRotation = 0;
                    
                    // Bonus coins for flips
                    coins += 5;
                    createParticles(v.x, v.y, '#ffd700', 10);
                }
            } else {
                if (airTime > 0.5) {
                    // Landing bonus
                    const bonus = Math.floor(airTime * 2);
                    coins += bonus;
                }
                airTime = 0;
                totalRotation = 0;
                flipCount = 0;
            }
            lastAngle = v.angle;
            
            // Gravity
            v.vy += CONFIG.gravity * config.weight;
            
            // Suspension physics
            if (v.wheels.front.grounded) {
                const penetration = frontBottom - (frontTerrainY - v.wheelRadius);
                v.wheels.front.compression = Math.min(penetration, v.maxSuspension);
                
                const springForce = v.wheels.front.compression * 0.25;
                const damping = v.vy * 0.1;
                
                v.vy -= springForce + damping;
                v.angularVelocity -= v.wheels.front.compression * 0.0015;
                
                // Create dust
                if (Math.abs(v.vx) > 2) {
                    createDust(v.wheels.front.x, frontTerrainY);
                }
            }
            
            if (v.wheels.rear.grounded) {
                const penetration = rearBottom - (rearTerrainY - v.wheelRadius);
                v.wheels.rear.compression = Math.min(penetration, v.maxSuspension);
                
                const springForce = v.wheels.rear.compression * 0.25;
                const damping = v.vy * 0.1;
                
                v.vy -= springForce + damping;
                v.angularVelocity += v.wheels.rear.compression * 0.0015;
                
                if (Math.abs(v.vx) > 2) {
                    createDust(v.wheels.rear.x, rearTerrainY);
                }
            }
            
            // Engine
            if (keys.gas && fuel > 0) {
                v.engineRunning = true;
                if (grounded) {
                    const terrainAngle = getTerrainAngle(v.x);
                    const power = config.power;
                    
                    v.vx += Math.cos(v.angle) * power;
                    v.vy += Math.sin(v.angle) * power * 0.3;
                    
                    // Exhaust particles
                    if (Math.random() < 0.3) {
                        createExhaust(v.x - cosA * 50, v.y - sinA * 10);
                    }
                } else {
                    // Less power in air
                    v.vx += Math.cos(v.angle) * config.power * 0.1;
                }
                fuel -= CONFIG.fuelConsumption;
            } else {
                v.engineRunning = false;
            }
            
            // Brake
            if (keys.brake && grounded) {
                v.vx *= CONFIG.groundFriction;
                
                // Brake dust
                if (Math.abs(v.vx) > 3) {
                    createDust(v.wheels.rear.x, rearTerrainY);
                }
            }
            
            // Lean controls
            const leanPower = grounded ? 0.004 : 0.006;
            if (keys.leanBack) {
                v.angularVelocity -= leanPower;
            }
            if (keys.leanForward) {
                v.angularVelocity += leanPower;
            }
            
            // Terrain 
